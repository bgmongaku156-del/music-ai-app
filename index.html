<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI音楽生成（商用利用OK）</title>

<style>
body{
background:black;
color:white;
text-align:center;
font-family:sans-serif;
}

textarea{
width:90%;
height:100px;
font-size:18px;
}

button{
padding:15px;
font-size:20px;
margin:10px;
background:green;
color:white;
border:none;
border-radius:10px;
}

button:disabled{
background:gray;
}

audio{
width:90%;
margin-top:20px;
}

</style>

</head>

<body>

<h2>AI音楽生成（商用利用OK）</h2>

<textarea id="prompt">
relaxing sleep music calm ambient no vocals
</textarea>

<br>

<button id="btn1" onclick="gen(60)">
1分生成
</button>

<button id="btn3" onclick="gen(180)">
3分生成
</button>

<br>

<div id="status"></div>

<audio id="player" controls></audio>

<br>

<a id="download" style="color:yellow"></a>

<script>

async function gen(sec){

document.getElementById("btn1").disabled=true
document.getElementById("btn3").disabled=true

document.getElementById("status").innerHTML="生成中..."

try{

let res=await fetch("/api/music",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
prompt:document.getElementById("prompt").value,
duration:sec
})
})

let data=await res.json()

if(!data.url){
throw "error"
}

document.getElementById("player").src=data.url

document.getElementById("download").href=data.url
document.getElementById("download").innerHTML="ダウンロード"

document.getElementById("status").innerHTML="生成完了"

}catch(e){

document.getElementById("status").innerHTML="生成失敗"

}

document.getElementById("btn1").disabled=false
document.getElementById("btn3").disabled=false

}

</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ja">

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>AI音楽生成＋ダウンロード</title>

<style>

body{
font-family:sans-serif;
text-align:center;
padding:30px;
background:#111;
color:white;
}

button{
font-size:18px;
padding:12px;
margin:8px;
border-radius:10px;
border:none;
background:#4CAF50;
color:white;
}

input{
font-size:18px;
padding:10px;
width:80%;
margin:10px;
}

audio{
width:90%;
margin-top:20px;
}

#status{
margin-top:10px;
color:#ccc;
}

</style>

</head>

<body>

<h2>AI音楽生成</h2>

<input id="prompt"
placeholder="例: battle music epic orchestra">

<br>

<button onclick="generate()">
AI生成
</button>

<button onclick="downloadMusic()">
ダウンロード
</button>

<div id="status">
待機中
</div>

<br>

<audio id="player" controls></audio>

<script>

let currentUrl="";

async function generate(){

document.getElementById("status").innerText="生成中...";

const prompt=
document.getElementById("prompt").value
|| "lofi chill music";

const res=
await fetch("/api/music?prompt="+prompt);

const data=
await res.json();

if(!data.url){

document.getElementById("status").innerText=
"生成失敗";

return;
}

currentUrl=data.url;

const player=
document.getElementById("player");

player.src=currentUrl;

player.play();

document.getElementById("status").innerText=
"生成完了";

}


function downloadMusic(){

if(!currentUrl){
alert("先に生成してください");
return;
}

const a=document.createElement("a");

a.href=currentUrl;

a.download="ai-music.mp3";

document.body.appendChild(a);

a.click();

document.body.removeChild(a);

}

</script>

</body>

</html>

<!DOCTYPE html>
<html>

<head>
<meta name="viewport" content="width=device-width">
</head>

<body style="background:black;color:white;font-family:sans-serif;padding:20px;">

<h2>AI音楽生成</h2>

<textarea id="prompt" style="width:100%;height:120px;font-size:18px;">
sleep relaxing ambient music no vocals
</textarea>

<button onclick="make(5)" style="width:100%;padding:20px;font-size:20px;margin-top:10px;">
5分生成
</button>

<button onclick="make(10)" style="width:100%;padding:20px;font-size:20px;margin-top:10px;">
10分生成
</button>

<audio id="player" controls style="width:100%;margin-top:20px;"></audio>

<script>

async function make(minutes){

let player=document.getElementById("player")

player.src=""

const prompt=
document.getElementById("prompt").value

const r=await fetch("/api/music",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
prompt:prompt,
minutes:minutes
})

})

const d=await r.json()

if(!d.urls){

alert("生成失敗")

return

}

let list=d.urls

let i=0

player.src=list[0]

player.onended=function(){

i++

if(i<list.length){

player.src=list[i]

player.play()

}

}

player.play()

}

</script>

</body>
</html>

<!DOCTYPE html>
<html>

<head>
<meta name="viewport" content="width=device-width">

<style>

body{
background:black;
color:white;
font-family:sans-serif;
padding:20px;
}

textarea{
width:100%;
height:120px;
font-size:18px;
}

button{
width:100%;
padding:20px;
font-size:20px;
margin-top:10px;
background:green;
color:white;
border:none;
border-radius:10px;
}

audio{
width:100%;
margin-top:20px;
}

</style>

</head>

<body>

<h2>AI音楽生成</h2>

<textarea id="prompt">

sleep relaxing music ambient no vocals

</textarea>

<button onclick="make(5)">
5分生成
</button>

<button onclick="make(10)">
10分生成
</button>

<audio id="player" controls></audio>

<script>

async function make(minutes){

const prompt =
document.getElementById("prompt").value;

const r =
await fetch("/api/music",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
prompt:prompt,
minutes:minutes
})
});

const d=await r.json();

let player=
document.getElementById("player");

// 結合再生
let playlist=d.urls

let i=0

player.src=playlist[i]

player.onended=function(){

i++

if(i<playlist.length){

player.src=playlist[i]

player.play()

}

}

player.play()

}

</script>

</body>

</html>
